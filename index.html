<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aufgabenübersicht</title>
    <style>
        body {
            background-color: #f4f6f9;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
            height: 100vh;
            color: #333;
        }
        .container {
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0px 6px 12px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 900px;
            text-align: center;
        }
        .instruction {
            margin-bottom: 30px;
            font-size: 18px;
            line-height: 1.6;
            color: #555;
        }
        .button-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        button {
            padding: 15px 25px;
            font-size: 16px;
            border: 2px solid #007bff;
            border-radius: 5px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
        }
        button:hover {
            background-color: #0056b3;
            transform: scale(1.05);
            box-shadow: 0px 4px 8px rgba(0, 91, 187, 0.3);
        }
        footer {
            margin-top: 40px;
            font-size: 14px;
            color: #888;
        }
        .title {
            font-size: 24px;
            margin-bottom: 10px;
            color: #007bff;
        }
        .notes {
            margin-top: 20px;
            text-align: left;
        }
        textarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            resize: none;
        }
        .word-counter {
            margin-top: 10px;
            font-size: 16px;
            color: #555;
            text-align: left;
        }
        #iframe-container {
            width: 100%;
            height: 80vh;
            margin-top: 20px;
            display: none;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">Test Tobii (Links zu 5 Webseiten)</h1>
        <div class="instruction">
            <p>Im Rahmen dieser Übung haben Sie Zugriff auf fünf verschiedene Quellen, die Ihnen helfen, die Aufgaben zu bearbeiten. Bitte navigieren Sie durch die Quellen, indem Sie auf die entsprechenden Buttons unten klicken. Sie gelangen dann direkt zur ausgewählten Quelle.</p>
            <p>Die zur Verfügung stehenden Quellen umfassen wichtige Informationen zu Mobilfunkmasten und deren Auswirkungen. Bitte stellen Sie sicher, dass Sie alle Quellen durchgehen, um Ihre Aufgaben bestmöglich zu bearbeiten.</p>
        </div>
        <div class="button-container">
            <button onclick="loadPage('https://www.deutschland-spricht-ueber-5g.de/informieren/mobilfunktechnik/alles-zum-mobilfunkmast/')">Funkmast 1</button>
            <button onclick="loadPage('https://www.bfs.de/DE/themen/emf/mobilfunk/mobilfunk_node.html')">Funkmast 2</button>
            <button onclick="loadPage('https://www.quarks.de/gesundheit/handystrahlung-wie-gefaehrlich-ist-das-neue-mobilfunknetz-5g/')">Funkmast 3</button>
            <button onclick="loadPage('https://www.zentrum-der-gesundheit.de/bibliothek/umwelt/strahlung/mobilfunkstrahlung-ia')">Funkmast 4</button>
            <button onclick="loadPage('https://www.tagesspiegel.de/potsdam/landeshauptstadt/geplanter-mobilfunkmast-anwohner-aus-grube-zeigen-sich-skeptisch-gegenuber-5g-netzausbau-11910113.html')">Funkmast 5</button>
        </div>

        <!-- Iframe für die Webseite -->
        <div id="iframe-container">
            <iframe id="pageFrame" src=""></iframe>
        </div>

        <div class="notes">
            <h2>Notizen</h2>
            <textarea id="notes" placeholder="Hier können Sie Ihre Notizen machen..."></textarea>
            <div class="word-counter">
                Wörter: <span id="wordCount">0</span>
            </div>
        </div>
        <button id="saveNotes">Notizen speichern</button>
        <footer>
            <p>Hinweis: Die Seiten sind innerhalb des Rahmens eingeschränkt. Externe Links sind deaktiviert.</p>
        </footer>
    </div>

    <script>
        const notesField = document.getElementById('notes');
        const wordCountSpan = document.getElementById('wordCount');
        const trackingData = [];

        // Beim Laden der Seite gespeicherte Notizen wiederherstellen
        window.onload = function () {
            const savedNotes = localStorage.getItem('userNotes');
            if (savedNotes) {
                notesField.value = savedNotes;
                updateWordCount(savedNotes);
            }
            startTracking();
        };

        // Notizen speichern und Wortanzahl aktualisieren
        notesField.addEventListener('input', function () {
            const text = notesField.value;
            localStorage.setItem('userNotes', text);
            updateWordCount(text);
        });

        function updateWordCount(text) {
            const wordCount = text.trim().split(/\s+/).filter(word => word.length > 0).length;
            wordCountSpan.textContent = wordCount;
        }

        function startTracking() {
            setInterval(() => {
                const timestamp = new Date().toISOString();
                const text = notesField.value;
                trackingData.push({ timestamp, textLength: text.length });
            }, 1000);
        }

        function loadPage(url) {
            document.getElementById("iframe-container").style.display = "block";
            const frame = document.getElementById("pageFrame");
            frame.src = url;

            frame.onload = function() {
                try {
                    const frameDoc = frame.contentDocument || frame.contentWindow.document;
                    if (frameDoc) {
                        const links = frameDoc.getElementsByTagName("a");
                        for (let link of links) {
                            link.removeAttribute("href");
                            link.style.pointerEvents = "none";
                            link.style.color = "gray";
                        }
                    }
                } catch (e) {
                    console.warn("Externe Seiten verhindern Link-Entfernung aufgrund von CORS.");
                }
            };
        }

        document.getElementById('saveNotes').addEventListener('click', function () {
            const notes = localStorage.getItem('userNotes') || '';
            let fileContent = "### Notizen ###\n\n" + notes + "\n\n### Zeichenentwicklung ###\n\n";
            trackingData.forEach(entry => {
                fileContent += `${entry.timestamp}: Zeichenanzahl = ${entry.textLength}\n`;
            });

            const blob = new Blob([fileContent], { type: 'text/plain' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'Notizen_und_Tracking.txt';
            a.click();
            URL.revokeObjectURL(a.href);
        });
    </script>
</body>
</html>
